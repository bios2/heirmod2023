[
  {
    "objectID": "slides/01_Data/index.html#illustrative-datasets",
    "href": "slides/01_Data/index.html#illustrative-datasets",
    "title": "Data used for this course",
    "section": "Illustrative datasets",
    "text": "Illustrative datasets\nTo illustrate the different models and methods we will discuss in this course, we will rely on a few data sets, which are directly available in different R package\n\nmite, mite.env and mite.xy available in the vegan R package\npenguins available in the palmerpenguins R package\n\nThese datasets are practical because they are manageable in size and will allow you to see how to work out the different example presented in this course.\nLet’s look at them in more details"
  },
  {
    "objectID": "slides/01_Data/index.html#oribatid-mite-data",
    "href": "slides/01_Data/index.html#oribatid-mite-data",
    "title": "Data used for this course",
    "section": "Oribatid mite data",
    "text": "Oribatid mite data\nAside from being a very interesting datasets this data has been sample on the southern shore of Lac Geai (a few minutes walk from here ! We will go see it this week)\nSampling was carried out in June 1989 on the partially floating vegetation mat surrounding the lake from the forest border to the free water by Daniel Borcard"
  },
  {
    "objectID": "slides/01_Data/index.html#oribatid-mite-data-1",
    "href": "slides/01_Data/index.html#oribatid-mite-data-1",
    "title": "Data used for this course",
    "section": "Oribatid mite data",
    "text": "Oribatid mite data\nOribatid mites are small (usually ranging in size from 0.2 to 1.4 mm) invertebrates that are part of the Arachnida class (so they have 8 legs).\n\nIn the mite data, 35 morphospecies were identified and counted across 70 samples."
  },
  {
    "objectID": "slides/01_Data/index.html#sites-coordinates",
    "href": "slides/01_Data/index.html#sites-coordinates",
    "title": "Data used for this course",
    "section": "Sites coordinates",
    "text": "Sites coordinates"
  },
  {
    "objectID": "slides/01_Data/index.html#vegetation-cover",
    "href": "slides/01_Data/index.html#vegetation-cover",
    "title": "Data used for this course",
    "section": "Vegetation cover",
    "text": "Vegetation cover\n{fig-align=“center” width = 105%}"
  },
  {
    "objectID": "slides/01_Data/index.html#microtopography-and-shrub-cover",
    "href": "slides/01_Data/index.html#microtopography-and-shrub-cover",
    "title": "Data used for this course",
    "section": "Microtopography and shrub cover",
    "text": "Microtopography and shrub cover\n{fig-align=“center” width = 105%}"
  },
  {
    "objectID": "slides/01_Data/index.html#substrate-density-and-water-content",
    "href": "slides/01_Data/index.html#substrate-density-and-water-content",
    "title": "Data used for this course",
    "section": "Substrate density and water content",
    "text": "Substrate density and water content\n{fig-align=“center” width = 105%}"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#complexe-hierarchical-model",
    "href": "slides/07_Complex_hierarchical_model/index.html#complexe-hierarchical-model",
    "title": "Complex hierarchical models",
    "section": "“Complexe” hierarchical model",
    "text": "“Complexe” hierarchical model"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#the-general-formulation",
    "href": "slides/07_Complex_hierarchical_model/index.html#the-general-formulation",
    "title": "Complex hierarchical models",
    "section": "The general formulation",
    "text": "The general formulation\n\nAs discuss yesterday, a linear model can be writen as\n\\[\\mathbf{y}\\sim \\mathcal{MVN}(\\mathbf{X} \\boldsymbol{\\beta}, \\sigma^2\\mathbf{I})\\]\nwhere\n\n\\(\\mathbf{y}\\) is a vector quantifying a response variable of length \\(n\\)\n\\(\\mathbf{X}\\) is a matrix of explanatory variables with \\(n\\) rows (samples) and \\(p\\) columns (explanatory varaibles)\n\\(\\boldsymbol{\\beta}\\) is a vector \\(p\\) pararameters weighting the importance of each explanatory variables in \\(\\mathbf{X}\\)\n\\(\\sigma^2\\) is a measure of variance of the error in the regression model\n\\(\\mathbf{I}\\) is an \\(n \\times n\\) identity matrix"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#a-very-general-formulation",
    "href": "slides/07_Complex_hierarchical_model/index.html#a-very-general-formulation",
    "title": "Complex hierarchical models",
    "section": "A (very !) general formulation",
    "text": "A (very !) general formulation\n\nA hierarchical model is a generalization of the linear model such that\n\\[(\\mathbf{y}|\\mathbf{b} )\\sim \\mathcal{MVN}(\\mathbf{X} \\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{b}, \\sigma^2\\mathbf{I})\\]\n\n\nwhere\n\n\\(\\mathbf{y}\\) is a vector quantifying a response variable of length \\(n\\)\n\\(\\mathbf{X}\\) is a matrix of explanatory variables with \\(n\\) rows (samples) and \\(p\\) columns (explanatory variables)\n\\(\\boldsymbol{\\beta}\\) is a vector \\(p\\) pararameters weighting the importance of each explanatory variables in \\(\\mathbf{X}\\)\n\\(\\sigma^2\\) is a measure of variance of the error in the regression model\n\\(\\mathbf{I}\\) is an \\(n \\times n\\) identity matrix\n\n\n\n\\(\\mathbf{Z}\\) is another matrix of explanatory variables with \\(n\\) rows (samples) and \\(q\\) columns (explanatory variables)\n\\(\\mathbf{b}\\) is a vector \\(q\\) pararameters weighting the importance of each explanatory variables in \\(\\mathbf{Z}\\)"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#a-very-general-formulation-1",
    "href": "slides/07_Complex_hierarchical_model/index.html#a-very-general-formulation-1",
    "title": "Complex hierarchical models",
    "section": "A (very !) general formulation",
    "text": "A (very !) general formulation\n\nA hierarchical model is a generalization of the linear model such that\n\\[(\\mathbf{y}|\\mathbf{b} )\\sim \\mathcal{MVN}(\\mathbf{X} \\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{b}, \\sigma^2\\mathbf{I})\\] What is also noticeable in this model is the conditional relationship between \\(\\mathbf{y}\\) and \\(\\mathbf{b}\\).\nSpecifically, in this formulation,\n\\[\\mathbf{b}\\sim \\mathcal{MVN}(\\mathbf{0}, \\mathbf{\\Sigma})\\] where \\(\\mathbf{\\Sigma}\\) is a covariance matrix.\nBased on this general formulation, we can now define all unconstrained hierarchical models."
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#y-1-fg",
    "href": "slides/07_Complex_hierarchical_model/index.html#y-1-fg",
    "title": "Complex hierarchical models",
    "section": "y ~ (1 | f/g)",
    "text": "y ~ (1 | f/g)\n\nOther notation used : (1 | f) + (1 | f:g)\nThis model assumes there is a hierarchy that varies among the levels of factor f and among the levels of factor g but only within the levels of factor f.\nMathematically, it can be translated to\n\\[\\mathbf{y} \\sim \\mathcal{MVN}(\\mathbf{b}_{f[l_f]} + \\mathbf{b}_{g[l_g]\\in f[l_f]},\\sigma^2\\mathbf{I}) \\quad\\forall\\quad l_f = 1\\dots k_f\\,\\,\\,\\,\\text{and}\\,\\,\\,l_g = 1\\dots k_g\\] or\n\\[y_i = b_{f[l_f]} + b_{g[l_g]\\in f[l_f]} + \\varepsilon \\quad\\forall\\quad l_f = 1\\dots k_f\\,\\,\\,\\,,\\,\\,\\,l_g = 1\\dots k_g\\,\\,\\,\\,\\text{and}\\,\\,\\,i = 1\\dots n\\] In words, this means that the model values \\(b\\) will change for a sample \\(i\\) only when the level \\(l_f\\) of the factor \\(f\\) changes or when the level \\(l_g\\) of the factor \\(g\\) within the level \\(l_f\\) of the factor \\(f\\) changes.\nThis is because in this model\n\\[\\mathbf{b} \\sim \\mathcal{N}\\left(0, \\begin{bmatrix}\n                                  \\sigma^2_f & 0\\\\\n                                  0& \\sigma^2_{g\\in f}\\\\\n                                \\end{bmatrix}\n                                \\right)\\]"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#y-1-fg-1",
    "href": "slides/07_Complex_hierarchical_model/index.html#y-1-fg-1",
    "title": "Complex hierarchical models",
    "section": "y ~ (1 | f/g)",
    "text": "y ~ (1 | f/g)\nStan code for this model\n\nFor Andrew?"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#y-1-fg-2",
    "href": "slides/07_Complex_hierarchical_model/index.html#y-1-fg-2",
    "title": "Complex hierarchical models",
    "section": "y ~ (1 | f/g)",
    "text": "y ~ (1 | f/g)"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#y-1-f-1-g",
    "href": "slides/07_Complex_hierarchical_model/index.html#y-1-f-1-g",
    "title": "Complex hierarchical models",
    "section": "y ~ (1 | f) + (1 | g)",
    "text": "y ~ (1 | f) + (1 | g)\n\nOther notation used : y ~ 1 + (1 | f) + (1 | g)\nThis model assumes there is a hierarchy that varies among the two factors.\nMathematically, it can be translated to\n\\[\\mathbf{y} \\sim \\mathcal{MVN}(\\mathbf{b}_{f[l_f]\\times g[l_g]},\\sigma^2\\mathbf{I}) \\quad\\forall\\quad l_f = 1\\dots k_f\\,\\,\\,\\,\\text{and}\\,\\,\\,l_g = 1\\dots k_g\\] or\n\\[y_i = b_{f_i[l_f]\\times g_i[l_g]} + \\varepsilon \\quad\\forall\\quad l_f = 1\\dots k_f\\,\\,\\,\\,,\\,\\,\\,l_g = 1\\dots k_g\\,\\,\\,\\,\\text{and}\\,\\,\\,i = 1\\dots n\\] In words, this means that the model values \\(b\\) will change for a sample \\(i\\) only when the interaction the level \\(l_f\\) of the factor \\(f\\) and the level \\(l_g\\) of the factor \\(g\\) changes.\nThis is because in this model\n\\[\\mathbf{b} \\sim \\mathcal{N}\\left(0,\n                                \\begin{bmatrix}\n                                  \\sigma^2_f & \\sigma_f\\sigma_g\\\\\n                                  \\sigma_f\\sigma_g& \\sigma^2_g\\\\\n                                \\end{bmatrix}\n                                \\right)\\]"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#y-1-f-1-g-1",
    "href": "slides/07_Complex_hierarchical_model/index.html#y-1-f-1-g-1",
    "title": "Complex hierarchical models",
    "section": "y ~ (1 | f) + (1 | g)",
    "text": "y ~ (1 | f) + (1 | g)\nThis model has a number interesting properties\n\nIt does not assumes that the two factors act independent. Actually, if you are interested in such a model, the code to use is not as straight forward to write with these packages.\nIf a particular levels is associated to the same samples for the two factors, usually this create technical problems and the model cannot be estimated properly (this is true regardless of how you estimate these parameter)\nThis can be generalized to as many factors as we want. We will see how this can be useful later."
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#y-x-x-g",
    "href": "slides/07_Complex_hierarchical_model/index.html#y-x-x-g",
    "title": "Complex hierarchical models",
    "section": "y ~ x + (x || g)",
    "text": "y ~ x + (x || g)"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#second",
    "href": "slides/07_Complex_hierarchical_model/index.html#second",
    "title": "Complex hierarchical models",
    "section": "second",
    "text": "second\n\nTest your model"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#section",
    "href": "slides/07_Complex_hierarchical_model/index.html#section",
    "title": "Complex hierarchical models",
    "section": "",
    "text": "img:\n\nit is a landscape"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#section-1",
    "href": "slides/07_Complex_hierarchical_model/index.html#section-1",
    "title": "Complex hierarchical models",
    "section": "",
    "text": "check with simulations"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#section-2",
    "href": "slides/07_Complex_hierarchical_model/index.html#section-2",
    "title": "Complex hierarchical models",
    "section": "",
    "text": "check with simulations"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#choose-parameters",
    "href": "slides/07_Complex_hierarchical_model/index.html#choose-parameters",
    "title": "Complex hierarchical models",
    "section": "choose parameters",
    "text": "choose parameters\nyintercept <- 4\nslope <- 1.3\nobs_error <- .5"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#make-up-an-x-variable",
    "href": "slides/07_Complex_hierarchical_model/index.html#make-up-an-x-variable",
    "title": "Complex hierarchical models",
    "section": "make up an X variable",
    "text": "make up an X variable\nyintercept <- 4\nslope <- 1.3\nobs_error <- .5\nx <- runif(200, min = -1, max = 1)"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#calculate-the-average",
    "href": "slides/07_Complex_hierarchical_model/index.html#calculate-the-average",
    "title": "Complex hierarchical models",
    "section": "calculate the average",
    "text": "calculate the average\nyintercept <- 4\nslope <- 1.3\nobs_error <- .5\nx <- runif(200, min = -1, max = 1)\ny_mean <- yintercept + slope * x"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#simulate-some-observations",
    "href": "slides/07_Complex_hierarchical_model/index.html#simulate-some-observations",
    "title": "Complex hierarchical models",
    "section": "simulate some observations",
    "text": "simulate some observations\n\nyintercept <- 4\nslope <- 1.3\nobs_error <- .5\nx <- runif(200, min = -1, max = 1)\ny_mean <- yintercept + slope * x\ny_obs <- rnorm(200, mean = y_mean, sd = obs_error)"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#finally-visualize",
    "href": "slides/07_Complex_hierarchical_model/index.html#finally-visualize",
    "title": "Complex hierarchical models",
    "section": "finally, visualize",
    "text": "finally, visualize\n\nplot(y_obs ~ x)"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#here-it-is-all-on-one-slide",
    "href": "slides/07_Complex_hierarchical_model/index.html#here-it-is-all-on-one-slide",
    "title": "Complex hierarchical models",
    "section": "here it is all on one slide",
    "text": "here it is all on one slide\n\n\nyintercept <- 4\nslope <- 1.3\nobs_error <- .5\nx <- runif(200, min = -1, max = 1)\ny_mean <- yintercept + slope * x\ny_obs <- rnorm(200, mean = y_mean, sd = obs_error)\nplot(y_obs, x)"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#or-we-can-present-the-code-and-results-separately",
    "href": "slides/07_Complex_hierarchical_model/index.html#or-we-can-present-the-code-and-results-separately",
    "title": "Complex hierarchical models",
    "section": "Or we can present the code and results separately",
    "text": "Or we can present the code and results separately\n\nThe codeThe figure\n\n\n\nyintercept <- 4\nslope <- 1.3\nobs_error <- .5\nx <- runif(200, min = -1, max = 1)\ny_mean <- yintercept + slope * x\ny_obs <- rnorm(200, mean = y_mean, sd = obs_error)\n\n\n\n\nplot(y_obs ~ x)"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#another-equation",
    "href": "slides/07_Complex_hierarchical_model/index.html#another-equation",
    "title": "Complex hierarchical models",
    "section": "another equation",
    "text": "another equation\n\\[\n2 + 4 = 6\n\\]"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#the-equation",
    "href": "slides/07_Complex_hierarchical_model/index.html#the-equation",
    "title": "Complex hierarchical models",
    "section": "The equation",
    "text": "The equation\n\\[\n\\begin{align}\ny  &\\sim \\text{N}(\\mu, \\sigma_{obs}) \\\\\n\\mu &= a + bx \\\\\n\\end{align}\n\\]"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#the-model",
    "href": "slides/07_Complex_hierarchical_model/index.html#the-model",
    "title": "Complex hierarchical models",
    "section": "The model",
    "text": "The model\ndata {\n  int<lower=0> N;\n  vector[N] y;\n}\nparameters {\n  real mu;\n  real<lower=0> sigma;\n}\nmodel {\n  y ~ normal(mu, sigma);\n  mu ~ normal(0, 1);\n  sigma ~ exponential(1);\n}"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#declare-the-data",
    "href": "slides/07_Complex_hierarchical_model/index.html#declare-the-data",
    "title": "Complex hierarchical models",
    "section": "Declare the data",
    "text": "Declare the data\ndata {\n  int<lower=0> N;\n  vector[N] y;\n}\nparameters {\n  real mu;\n  real<lower=0> sigma;\n}\nmodel {\n  y ~ normal(mu, sigma);\n  mu ~ normal(0, 1);\n  sigma ~ exponential(1);\n}"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#state-parameters",
    "href": "slides/07_Complex_hierarchical_model/index.html#state-parameters",
    "title": "Complex hierarchical models",
    "section": "State parameters",
    "text": "State parameters\ndata {\n  int<lower=0> N;\n  vector[N] y;\n}\nparameters {\n  real mu;\n  real<lower=0> sigma;\n}\nmodel {\n  y ~ normal(mu, sigma);\n  mu ~ normal(0, 1);\n  sigma ~ exponential(1);\n}"
  },
  {
    "objectID": "slides/07_Complex_hierarchical_model/index.html#write-the-likelihood-and-priors",
    "href": "slides/07_Complex_hierarchical_model/index.html#write-the-likelihood-and-priors",
    "title": "Complex hierarchical models",
    "section": "Write the likelihood and priors",
    "text": "Write the likelihood and priors\ndata {\n  int<lower=0> N;\n  vector[N] y;\n}\nparameters {\n  real mu;\n  real<lower=0> sigma;\n}\nmodel {\n  y ~ normal(mu, sigma);\n  mu ~ normal(0, 1);\n  sigma ~ exponential(1);\n}"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#simple-hierarchical-model",
    "href": "slides/06_Simple_hierarchical_model/index.html#simple-hierarchical-model",
    "title": "‘Simple’ hierarchical models",
    "section": "“Simple” hierarchical model",
    "text": "“Simple” hierarchical model\nHere, we use the term “simple” in a rather loose way to discuss hierarchical models without any constrains, whether they are spatial, temporal, phylogenetic or others.\nFuthermore, for most of this lecture, we will focus on models with a Gaussian error term to develop the underlying theory.\nWhen we will have done this, it will be reasonably straight forward to move to non-Gaussian hierarchical model."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#a-very-general-formulation",
    "href": "slides/06_Simple_hierarchical_model/index.html#a-very-general-formulation",
    "title": "‘Simple’ hierarchical models",
    "section": "A (very !) general formulation",
    "text": "A (very !) general formulation\n\nAs discuss yesterday, a linear model can be writen as\n\\[(\\mathbf{y}|\\mathbf{X}, \\boldsymbol{\\beta}, \\sigma_\\mathbf{y}^2)\\sim \\mathcal{MVN}(\\mathbf{X} \\boldsymbol{\\beta}, \\sigma\\mathbf{y}^2\\mathbf{I})\\]\nwhere\n\n\\(\\mathbf{y}\\) is a vector quantifying a response variable of length \\(n\\)\n\\(\\mathbf{X}\\) is a matrix of explanatory variables with \\(n\\) rows (samples) and \\(p\\) columns (explanatory varaibles)\n\\(\\boldsymbol{\\beta}\\) is a vector \\(p\\) pararameters weighting the importance of each explanatory variables in \\(\\mathbf{X}\\)\n\\(\\sigma_\\mathbf{y}^2\\) is a measure of variance of the error in the regression model\n\\(\\mathbf{I}\\) is an \\(n \\times n\\) identity matrix"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#a-very-general-formulation-1",
    "href": "slides/06_Simple_hierarchical_model/index.html#a-very-general-formulation-1",
    "title": "‘Simple’ hierarchical models",
    "section": "A (very !) general formulation",
    "text": "A (very !) general formulation\n\nA hierarchical model is a generalization of the linear model such that\n\\[(\\mathbf{y}|\\mathbf{X},\\mathbf{Z}, \\boldsymbol{\\beta}, \\mathbf{b}, \\sigma_\\mathbf{y}^2)\\sim \\mathcal{MVN}(\\mathbf{X} \\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{b}, \\sigma_\\mathbf{y}^2\\mathbf{I})\\]\n\n\nwhere\n\n\\(\\mathbf{y}\\) is a vector quantifying a response variable of length \\(n\\)\n\\(\\mathbf{X}\\) is a matrix of explanatory variables with \\(n\\) rows (samples) and \\(p\\) columns (explanatory variables)\n\\(\\boldsymbol{\\beta}\\) is a vector \\(p\\) pararameters weighting the importance of each explanatory variables in \\(\\mathbf{X}\\)\n\\(\\sigma_\\mathbf{y}^2\\) is a measure of variance of the error in the regression model\n\\(\\mathbf{I}\\) is an \\(n \\times n\\) identity matrix\n\n\n\n\\(\\mathbf{Z}\\) is another matrix of explanatory variables with \\(n\\) rows (samples) and \\(q\\) columns (explanatory variables)\n\\(\\mathbf{b}\\) is a vector \\(q\\) pararameters weighting the importance of each explanatory variables in \\(\\mathbf{Z}\\)"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#a-very-general-formulation-2",
    "href": "slides/06_Simple_hierarchical_model/index.html#a-very-general-formulation-2",
    "title": "‘Simple’ hierarchical models",
    "section": "A (very !) general formulation",
    "text": "A (very !) general formulation\n\nA hierarchical model is a generalization of the linear model such that\n\\[(\\mathbf{y}|\\mathbf{b} )\\sim \\mathcal{MVN}(\\mathbf{X} \\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{b}, \\sigma^2\\mathbf{I})\\] What is also noticeable in this model is the conditional relationship between \\(\\mathbf{y}\\) and \\(\\mathbf{b}\\).\nSpecifically, in this formulation,\n\\[\\mathbf{b}\\sim \\mathcal{MVN}(\\mathbf{0}, \\mathbf{\\Sigma})\\] where \\(\\mathbf{\\Sigma}\\) is a covariance matrix.\nBased on this general formulation, we can now define all unconstrained hierarchical models."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#the",
    "href": "slides/06_Simple_hierarchical_model/index.html#the",
    "title": "‘Simple’ hierarchical models",
    "section": "The “|”",
    "text": "The “|”\n\nMost of you have probably already used the packages lme4 or brms to build hierarchical models and so you have used the | to include a hierachy in your model.\nBut do you know what the underlying mathematical structure of the model you built look like ? Does it really answer the question you were asking ?\n\n\n\nLet’s look at different lme4 models to learn about some basic (and not so basic!) hierarchical models."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#a-bit-of-notation",
    "href": "slides/06_Simple_hierarchical_model/index.html#a-bit-of-notation",
    "title": "‘Simple’ hierarchical models",
    "section": "A bit of notation",
    "text": "A bit of notation\nBefore we get into writing math, we need to define a bit of notation in addition of the one we have used so far.\nSpecifically, when define a hierarchy in a model, it is common to do this using at least one factor. Mathematically, we will define the different level of a factor in a model by a subscript.\nWe will use square brackets to define the level of interest\nExample\n\\[\\mathbf{Z}_{f[l]}\\] This means that, within \\(\\mathbf{Z}\\), we focus on \\(l^{\\text{th}}\\) level of factor \\(f\\)."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercept",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercept",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the intercept",
    "text": "Hierarchy on the intercept\n\nlme4 notation used y ~ (1 | f) or y ~ 1 + (1 | f)\nThis model assumes there is a hierarchy solely on the intercept.\nMathematically, it can be translated to\n\\[\\mathbf{y} \\sim \\mathcal{MVN}(\\mathbf{b}_{f[l]},\\sigma^2\\mathbf{I}) \\quad \\forall\\quad l = 1\\dots k\\] or\n\\[y_i = b_{{f_i[l]}} + \\varepsilon \\quad \\forall\\quad l = 1\\dots k\\,\\,\\,\\,\\text{and}\\,\\,\\,i = 1\\dots n\\] In words, this means that the model values \\(b\\) will change for a sample \\(i\\) only when the level \\(l\\) of the factor \\(f\\) changes.\nThis is because in this model\n\\[\\mathbf{b} \\sim \\mathcal{N}(0, \\sigma^2_f)\\]"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercept-1",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercept-1",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the intercept",
    "text": "Hierarchy on the intercept"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercept-2",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercept-2",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the intercept",
    "text": "Hierarchy on the intercept"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the slopes",
    "text": "Hierarchy on the slopes\n\nlme4 notation : y ~ 1 + (x | f)\nThis model assumes there is a hierarchy on the parameters associated to variable x.\nMathematically, it can be translated to\n\\[\\mathbf{y} \\sim \\mathcal{MVN}(\\beta_0 + \\mathbf{Z}\\mathbf{b}_{f[l_f]},\\sigma^2\\mathbf{I}) \\quad\\forall\\quad l_f = 1\\dots k_f\\] or\n\\[y_i = \\beta_0 + b_{f[l_f]}z_i + \\varepsilon \\quad\\forall\\quad l_f = 1\\dots k_f\\,\\,\\,\\,\\text{and}\\,\\,\\,i = 1\\dots n\\] In words, this means that the weight on variable \\(z\\) will change for a sample \\(i\\) only when the level \\(l\\) of the factor \\(f\\) changes.\nThis is because in this model\n\\[\\mathbf{b} \\sim \\mathcal{N}(0, \\sigma^2_f)\\]"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes-1",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes-1",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the slopes",
    "text": "Hierarchy on the slopes"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes-2",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes-2",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the slopes",
    "text": "Hierarchy on the slopes"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-intercept-and-slope",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-intercept-and-slope",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on intercept and slope",
    "text": "Hierarchy on intercept and slope\nMathematically speaking, what are the differences between having a hierarchy on the intercept and a slope ? Any idea ?"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-intercept-and-slope-1",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-intercept-and-slope-1",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on intercept and slope",
    "text": "Hierarchy on intercept and slope\nAnswer : Very little !\n\nActually, if we return the way \\(\\mathbf{b}\\) is defined we see that in both case it is defined as\n\\[\\mathbf{b} \\sim \\mathcal{N}(0, \\sigma^2_f)\\] with the sole difference that \\(\\mathbf{b}\\) linked to an explanatory variable when the hierarchy is on the slope, while when the hierarchy is on the intercept it is not linked to any explanatory variable.\nWell… Actually… When a hierarchy is applied on the intercept it is technically associated to a constant explanatory variable."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#how-many-levels",
    "href": "slides/06_Simple_hierarchical_model/index.html#how-many-levels",
    "title": "‘Simple’ hierarchical models",
    "section": "How many levels ?",
    "text": "How many levels ?\nA common question that often gets asked is :\n“How many level is enough ?”\nThis is a simple questions that sadly does not have a simple answer."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-1",
    "href": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-1",
    "title": "‘Simple’ hierarchical models",
    "section": "How many levels ?",
    "text": "How many levels ?\nIn these types of models we are interested in estimating the variance parameter \\(\\sigma^2_f\\) in\n\\[\\mathbf{b} \\sim \\mathcal{N}(0, \\sigma^2_f)\\] to get the best estimation of \\(\\mathbf{b}\\).\nSo, another way to ask this question is “What is the minimum number of samples needed to properly estimate the variance of a Gaussian distribution?”\nHowever, in the context of how we defined hierarchical models, a sample amounts to being the level of a factor."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-2",
    "href": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-2",
    "title": "‘Simple’ hierarchical models",
    "section": "How many levels ?",
    "text": "How many levels ?\nWhat is the minimum number of samples needed to properly estimate the variance of a Gaussian distribution?\nIs 3 enough ?\n\n\n\n\n\n\n\n\n\n\n\n\nTrue variance : 0.25\nEstimated variance : 0.234"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-3",
    "href": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-3",
    "title": "‘Simple’ hierarchical models",
    "section": "How many levels ?",
    "text": "How many levels ?\nWhat is the minimum number of samples needed to properly estimate the variance of a Gaussian distribution?\nMaybe 5 ?\n\n\n\n\n\n\n\n\n\n\n\n\nTrue variance : 0.25\nEstimated variance : 0.12"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-4",
    "href": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-4",
    "title": "‘Simple’ hierarchical models",
    "section": "How many levels ?",
    "text": "How many levels ?\nWhat is the minimum number of samples needed to properly estimate the variance of a Gaussian distribution?\nOr 10 ?\n\n\n\n\n\n\n\n\n\n\n\n\nTrue variance : 0.25\nEstimated variance : 0.174"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-5",
    "href": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-5",
    "title": "‘Simple’ hierarchical models",
    "section": "How many levels ?",
    "text": "How many levels ?\nWhat is the minimum number of samples needed to properly estimate the variance of a Gaussian distribution?\nOr 50 ?\n\n\n\n\n\n\n\n\n\n\n\n\nTrue variance : 0.25\nEstimated variance : 0.331"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-6",
    "href": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-6",
    "title": "‘Simple’ hierarchical models",
    "section": "How many levels ?",
    "text": "How many levels ?\nWhat is the minimum number of samples needed to properly estimate the variance of a Gaussian distribution?\nOr 100 ?\n\n\n\n\n\n\n\n\n\n\n\n\nTrue variance : 0.25\nEstimated variance : 0.271"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-7",
    "href": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-7",
    "title": "‘Simple’ hierarchical models",
    "section": "How many levels ?",
    "text": "How many levels ?\nWhat is the minimum number of samples needed to properly estimate the variance of a Gaussian distribution?\nOr 1000 ?\n\n\n\n\n\n\n\n\n\n\n\n\nTrue variance : 0.25\nEstimated variance : 0.251"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-8",
    "href": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-8",
    "title": "‘Simple’ hierarchical models",
    "section": "How many levels ?",
    "text": "How many levels ?\nThere is a consensus among researchers working intimately with hierarchical that when the interest is to properly estimate the variance parameter \\(\\sigma^2\\), 5 or 6 levels is the extreme minimum.\n\nIn the book Richly Parameterized Linear Models: Additive, Time Series, and Spatial Models Using Random Effects, James S. Hodges (2016) makes this very thoughtful statement :\n\n“Treating factors with small numbers of levels as random will in the best case lead to very small and/or imprecise estimates of random effects; in the worst case it will lead to various numerical difficulties such as lack of convergence, zero variance estimates, etc.”"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-9",
    "href": "slides/06_Simple_hierarchical_model/index.html#how-many-levels-9",
    "title": "‘Simple’ hierarchical models",
    "section": "How many levels ?",
    "text": "How many levels ?\nSo, what to do if the number of level is not high enough for your comfort ?\nYou can still use the hierarchy in your model but focus on the mean of the levels instead of the variance.\nHow does this translate mathematically, with what we have seen so far ?"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the intercept’s mean",
    "text": "Hierarchy on the intercept’s mean\n\n\\[\\mathbf{y} \\sim \\mathcal{MVN}(\\boldsymbol{\\beta}_{f[l]},\\sigma_\\mathbf{y}^2\\mathbf{I}) \\quad \\forall\\quad l = 1\\dots k\\] or\n\\[y_i = \\beta_{f_i[l]} + \\varepsilon \\quad \\forall\\quad l = 1\\dots k\\,\\,\\,\\,\\text{and}\\,\\,\\,i = 1\\dots n\\] In this model, we assume that \\(\\boldsymbol{\\beta}_{f[l]}\\) is distributed as\n\\[\\boldsymbol{\\beta}_{f[l]} \\sim \\mathcal{N}(\\mu_{f}, \\sigma^2_{f})\\] In words, this means that all the samples among the \\(l^\\text{th}\\) level of factor \\(f\\) are used to estimate \\(\\boldsymbol{\\beta}_{f[l]}\\).\nBy developping our model this way, we focus on estimating the mean of groups in the hierarchy instead of only the variance."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean-1",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean-1",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the intercept’s mean",
    "text": "Hierarchy on the intercept’s mean\n\nLet’s take a deeper look at \\[\\boldsymbol{\\beta}_{f[l]} \\sim \\mathcal{N}(\\mu_{f}, \\sigma^2_{f})\\] When we study this way of sampling \\(\\boldsymbol{\\beta}_{f[l]}\\), although our interest is more on \\(\\mu_{f}\\), we also have to estimate the variance term \\(\\sigma^2_{f}\\).\nNote: This is essentially the same thing as a one-way analysis of variance."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean-2",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean-2",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the intercept’s mean",
    "text": "Hierarchy on the intercept’s mean"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean-3",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean-3",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the intercept’s mean",
    "text": "Hierarchy on the intercept’s mean\n\nHowever, it can be assumed to be all the same variance regardless of the group considered\n\n\\[\\mathbf{D}_f = \\begin{bmatrix}\n                \\sigma^2_{f} & 0 & \\dots & 0 & \\dots & 0\\\\\n                0 & \\sigma^2_{f} & \\dots & 0 & \\dots & 0\\\\\n                \\vdots & \\vdots & \\ddots & \\vdots & & \\vdots\\\\\n              0 & 0 & \\dots & \\sigma^2_{f} & \\dots & 0\\\\\n            \\vdots & \\vdots & & \\vdots & \\ddots & \\vdots\\\\\n            0 & 0 & \\dots & 0 & \\dots & \\sigma^2_{f}\\\\\n        \\end{bmatrix}\\]\n\nIn this case, \\(\\boldsymbol{\\beta}_{f} \\sim \\mathcal{MVN}(\\boldsymbol{\\mu}_{f}, \\mathbf{D}_f)\\) can be rewritten as \\[\\boldsymbol{\\beta}_{f} \\sim \\mathcal{MVN}(\\boldsymbol{\\mu}_{f}, \\sigma^2_{f}\\mathbf{I})\\] Note: This is essentially the same thing as a one-way analysis of variance."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean-4",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean-4",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the intercept’s mean",
    "text": "Hierarchy on the intercept’s mean"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean-5",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-intercepts-mean-5",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the intercept’s mean",
    "text": "Hierarchy on the intercept’s mean"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes-mean",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes-mean",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the slope’s mean",
    "text": "Hierarchy on the slope’s mean\n\nDevelopping a hierarchy on the slope’s mean translate mathematically in a very similar way as it does for the intercept.\n\\[\\mathbf{y} \\sim \\mathcal{MVN}(\\boldsymbol{\\beta}_0+\\mathbf{X}\\boldsymbol{\\beta}_{f[l]},\\sigma_\\mathbf{y}^2\\mathbf{I}) \\quad \\forall\\quad l = 1\\dots k\\] or\n\\[y_i = \\beta_0 + \\beta_{f_i[l]}x_i + \\varepsilon \\quad \\forall\\quad l = 1\\dots k\\,\\,\\,\\,\\text{and}\\,\\,\\,i = 1\\dots n\\] In this model, we assume that \\(\\boldsymbol{\\beta}_{f[l]}\\) is distributed as\n\\[\\boldsymbol{\\beta}_{f[l]} \\sim \\mathcal{N}(\\mu_{f}, \\sigma^2_{f})\\] In words, this means that all the samples among the \\(l^\\text{th}\\) level of factor \\(f\\) are used to estimate \\(\\boldsymbol{\\beta}_{f[l]}\\).\nBy developping our model this way, we focus on estimating the average slope for each group in the hierarchy instead of only the variance."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes-mean-1",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes-mean-1",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the slope’s mean",
    "text": "Hierarchy on the slope’s mean"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes-mean-2",
    "href": "slides/06_Simple_hierarchical_model/index.html#hierarchy-on-the-slopes-mean-2",
    "title": "‘Simple’ hierarchical models",
    "section": "Hierarchy on the slope’s mean",
    "text": "Hierarchy on the slope’s mean\nStan code\n\nFor Andrew?"
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#tracking-the-estimated-parameters",
    "href": "slides/06_Simple_hierarchical_model/index.html#tracking-the-estimated-parameters",
    "title": "‘Simple’ hierarchical models",
    "section": "Tracking the estimated parameters",
    "text": "Tracking the estimated parameters\n\nAs can be seen, it is important in hierarchical model to track the different parameters that are estimated to make sure we can make proper inferences with our model.\nHowever, we need to be careful because the notation used can play trick on us. This is especially true when using matrix notation.\nFor example, in\n\\[\\mathbf{b}_{f}\\sim \\mathcal{MVN}(\\mathbf{0}, \\mathbf{\\Sigma})\\] the number of levels are not explicitly defined and it is not clear if $ $ includes the same variance value on the diagonal or different ones and whether the off diagonal elements are 0 or another values.\nIn any case, make sure to keep track of the estimated parameters so that you can better understand the limits of the model you are building and using."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#choosing-the-right-model",
    "href": "slides/06_Simple_hierarchical_model/index.html#choosing-the-right-model",
    "title": "‘Simple’ hierarchical models",
    "section": "Choosing the right model",
    "text": "Choosing the right model\nAlthough these different models are mathematically quite similar, they approach very different biological questions.\nA comparison of the different figures caricaturizing how each model works should give a good insight about what each model can do.\nIt is thus important to make sure you design your biological question well so that deciding on which model to use is reasonably straight forward."
  },
  {
    "objectID": "slides/06_Simple_hierarchical_model/index.html#move-this-in-another-place",
    "href": "slides/06_Simple_hierarchical_model/index.html#move-this-in-another-place",
    "title": "‘Simple’ hierarchical models",
    "section": "Move this in another place",
    "text": "Move this in another place\nTechnically, we can sample all \\(\\boldsymbol{\\beta}_{f[l]}\\) independently, however, using multivariate Gaussian distribution, we can sample the \\(\\boldsymbol{\\beta}_{f}\\) for all levels of the factor in one go as\n\\[\\boldsymbol{\\beta}_{f} \\sim \\mathcal{MVN}(\\boldsymbol{\\mu}_{f}, \\mathbf{D}_f)\\] where\n\n\\(\\boldsymbol{\\mu}_{f}\\) is a vector of \\(k\\) means, one for each level of the factor\n\\(\\mathbf{D}_f\\) is a \\(k\\times k\\) diagonal matrix with variance term on the diagonal"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#square-matrix",
    "href": "slides/nn_extra_slides/index.html#square-matrix",
    "title": "Extra stuff",
    "section": "Square matrix",
    "text": "Square matrix\nThe square matrix has as many rows at it has columns \\[\n\\mathbf{B} = \\begin{bmatrix}\n                B_{11} & B_{12} & \\dots & B_{1j} & \\dots & B_{1n}\\\\\n                B_{21} & B_{22} & \\dots & B_{2j} & \\dots & B_{2n}\\\\\n                \\vdots & \\vdots & \\ddots & \\vdots & & \\vdots\\\\\n              B_{i1} & B_{i2} & \\dots & B_{ij} & \\dots & B_{in}\\\\\n            \\vdots & \\vdots & & \\vdots & \\ddots & \\vdots\\\\\n            B_{n1} & B_{n2} & \\dots & B_{nj} & \\dots & B_{nn}\\\\\n        \\end{bmatrix}\n\\]"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#determinant-of-a-matrix",
    "href": "slides/nn_extra_slides/index.html#determinant-of-a-matrix",
    "title": "Extra stuff",
    "section": "Determinant of a matrix",
    "text": "Determinant of a matrix\nNot sure if it should be included or not"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#eigenvectors-and-eigenvalues",
    "href": "slides/nn_extra_slides/index.html#eigenvectors-and-eigenvalues",
    "title": "Extra stuff",
    "section": "Eigenvectors and eigenvalues",
    "text": "Eigenvectors and eigenvalues\n\nRight eigenvector is :\n\\[\\mathbf{A}\\mathbf{w} = \\lambda\\mathbf{w}\\] Left eigenvector is :\n\\[\\mathbf{v}\\mathbf{A} = \\lambda\\mathbf{v}\\]\nRules\n\n\\(\\mathbf{A}\\) has to be a square matrix\nIf \\(\\mathbf{w}\\) is an eigenvector of \\(\\mathbf{A}\\), so is \\(c\\mathbf{w}\\) for any value of \\(c \\neq0\\)\nThe right eigenvector of \\(\\mathbf{A}^T\\) is the left eigenvector of \\(\\mathbf{A}\\)\nEigenvectors are linearly independent"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#positive-definite-matrix",
    "href": "slides/nn_extra_slides/index.html#positive-definite-matrix",
    "title": "Extra stuff",
    "section": "Positive definite matrix",
    "text": "Positive definite matrix\nIt is reasonably common when you build a hierarchical model to get an error message that state :\n\nError: Matrix X is not positive definite\n\nor similarly\n\nError: Matrix X is not positive semi-definite\n\nWhat does this mean ? Any idea ?"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#positive-semi-definite-matrix",
    "href": "slides/nn_extra_slides/index.html#positive-semi-definite-matrix",
    "title": "Extra stuff",
    "section": "Positive (semi-)definite matrix",
    "text": "Positive (semi-)definite matrix\nNerdy mathematical definition\nPositive definite matrix\n\\(\\mathbf{M}\\) is a positive definite matrix if, for any real vector \\(\\mathbf{z}\\), \\(\\mathbf{z}^t\\mathbf{M}\\mathbf{z} > 0\\)\nPositive semi-definite matrix\n\\(\\mathbf{M}\\) is a positive semi-definite matrix if, for any real vector \\(\\mathbf{z}\\), \\(\\mathbf{z}^t\\mathbf{M}\\mathbf{z} \\ge 0\\)"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#positive-semi-definite-matrix-1",
    "href": "slides/nn_extra_slides/index.html#positive-semi-definite-matrix-1",
    "title": "Extra stuff",
    "section": "Positive (semi-)definite matrix",
    "text": "Positive (semi-)definite matrix\nChecking if a matrix is positive (semi-)definite\nThe properties of eigenvalues can be used to detect if a matrix is positive (semi-) definite.\nAll we have to do is look at the eigenvalue of a square matrix.\nIf all eigenvalues of a matrix \\(\\mathbf{M}\\) larger than 0, matrix \\(\\mathbf{M}\\) is positive definite.\nIf all eigenvalues of a matrix \\(\\mathbf{M}\\) larger than or equal ro 0, matrix \\(\\mathbf{M}\\) is positive semi-definite."
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#dot-product",
    "href": "slides/nn_extra_slides/index.html#dot-product",
    "title": "Extra stuff",
    "section": "Dot product",
    "text": "Dot product\n\\[\\mathbf{v} \\cdot \\mathbf{x}= v_1x_1+v_2x_2+\\dots + v_nx_n\\]\n\n\\[\n            \\begin{bmatrix}\n                3 & 1\\\\\n            \\end{bmatrix}\n            \\cdot\n            \\begin{bmatrix}\n                2\\\\ 5\\\\\n            \\end{bmatrix} =\n                3 \\times  2 + 1 \\times 5 = 11\n\\]\n\nIn R\n\nv <- c(3, 1)\nx <- c(2,5)\nsum(v * x)\n\n[1] 11"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#solving-systems-of-linear-equation",
    "href": "slides/nn_extra_slides/index.html#solving-systems-of-linear-equation",
    "title": "Extra stuff",
    "section": "Solving systems of linear equation",
    "text": "Solving systems of linear equation\n\\[\n\\begin{align*}\n        1 &= 3\\beta_1 + 5\\beta_2 - 4\\beta_3 \\\\\n        0 &= \\beta_1 - 2\\beta_2 + 3\\beta_3\\\\\n        1 &= 4\\beta_1 + 6\\beta_2 + 5\\beta_3\\\\\n    \\end{align*}\n\\] \\[\n\\mathbf{y} \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\qquad \\mathbf{X} \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\qquad \\boldsymbol{\\beta}\n\\] \\[\n        \\begin{bmatrix}\n            1\\\\ 0\\\\ 1\\\\\n        \\end{bmatrix}=\n        \\begin{bmatrix}\n            3 & 5 & -4\\\\\n            1 & -2 & 3\\\\\n            4 & 6 & 5 \\\\\n        \\end{bmatrix}\n        \\begin{bmatrix}\n            \\beta_1\\\\ \\beta_2\\\\ \\beta_3\\\\\n        \\end{bmatrix}\n\\]"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#solving-systems-of-linear-equation-1",
    "href": "slides/nn_extra_slides/index.html#solving-systems-of-linear-equation-1",
    "title": "Extra stuff",
    "section": "Solving systems of linear equation",
    "text": "Solving systems of linear equation\n\n\\[\n\\mathbf{y} \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\qquad \\mathbf{X} \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\qquad \\boldsymbol{\\beta}\n\\] \\[\n        \\begin{bmatrix}\n            1\\\\ 0\\\\ 1\\\\\n        \\end{bmatrix}=\n        \\begin{bmatrix}\n            3 & 5 & -4\\\\\n            1 & -2 & 3\\\\\n            4 & 6 & 5 \\\\\n        \\end{bmatrix}\n        \\begin{bmatrix}\n            \\beta_1\\\\ \\beta_2\\\\ \\beta_3\\\\\n        \\end{bmatrix}\n\\]\nHow do we mathematically solve for \\(\\boldsymbol{\\beta}\\)?\n\\[\n    \\begin{align*}\n        \\mathbf{y} &= \\mathbf{X}\\boldsymbol{\\beta}\\\\\n        \\mathbf{X}^{-1}\\mathbf{y} &= \\mathbf{X}^{-1}\\mathbf{X}\\boldsymbol{\\beta}\\\\\n        \\mathbf{X}^{-1}\\mathbf{y} &= \\mathbf{I}\\boldsymbol{\\beta}\\\\\n        \\mathbf{X}^{-1}\\mathbf{y} &= \\boldsymbol{\\beta}\\\\\n    \\end{align*}\n\\]"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#solving-systems-of-linear-equation-2",
    "href": "slides/nn_extra_slides/index.html#solving-systems-of-linear-equation-2",
    "title": "Extra stuff",
    "section": "Solving systems of linear equation",
    "text": "Solving systems of linear equation\n\n\\[\n\\mathbf{y} \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\qquad \\mathbf{X} \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\qquad \\boldsymbol{\\beta}\n\\] \\[\n        \\begin{bmatrix}\n            1\\\\ 0\\\\ 1\\\\\n        \\end{bmatrix}=\n        \\begin{bmatrix}\n            3 & 5 & -4\\\\\n            1 & -2 & 3\\\\\n            4 & 6 & 5 \\\\\n        \\end{bmatrix}\n        \\begin{bmatrix}\n            \\beta_1\\\\ \\beta_2\\\\ \\beta_3\\\\\n        \\end{bmatrix}\n\\]\nHow do we solve for \\(\\boldsymbol{\\beta}\\) in R?\n\nX <- matrix(c(3, 1, 4, 5, -2, 6, -4, 3, 5), nrow = 3, ncol = 3)\ny <- c(1, 0, 1)\n\n(beta <- solve(X, y))\n\n[1]  0.20000000  0.05714286 -0.02857143"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#a-few-words-about-the-prior",
    "href": "slides/nn_extra_slides/index.html#a-few-words-about-the-prior",
    "title": "Extra stuff",
    "section": "A few words about the prior",
    "text": "A few words about the prior\nConjugate priors\nThese types of priors are convenient to use because\n\nThey are computationally faster to use\nThey can be interepreted as additional data\n\nWhy are they useful?\nThere is no need to write the likelihood down when using them. All that needs to be done is to sample them to obtain a parameter estimation."
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#a-few-words-about-the-prior-1",
    "href": "slides/nn_extra_slides/index.html#a-few-words-about-the-prior-1",
    "title": "Extra stuff",
    "section": "A few words about the prior",
    "text": "A few words about the prior\nConjugate priors\nWhat does it mean to be of the same functional form?\nIt means that both distribution have th same mathematical structure.\n\n\nBinomial distribution \\[\\theta^a(1-\\theta)^b\\]\n\nBeta distribution \\[\\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}\\]\n\n\nhttps://en.wikipedia.org/wiki/Conjugate_prior"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#move-this-in-another-place",
    "href": "slides/nn_extra_slides/index.html#move-this-in-another-place",
    "title": "Extra stuff",
    "section": "Move this in another place",
    "text": "Move this in another place\nTechnically, we can sample all \\(\\boldsymbol{\\beta}_{f[l]}\\) independently, however, using multivariate Gaussian distribution, we can sample the \\(\\boldsymbol{\\beta}_{f}\\) for all levels of the factor in one go as\n\\[\\boldsymbol{\\beta}_{f} \\sim \\mathcal{MVN}(\\boldsymbol{\\mu}_{f}, \\mathbf{D}_f)\\] where\n\n\\(\\boldsymbol{\\mu}_{f}\\) is a vector of \\(k\\) means, one for each level of the factor\n\\(\\mathbf{D}_f\\) is a \\(k\\times k\\) diagonal matrix with variance term on the diagonal"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#hierarchy-on-the-intercepts-mean",
    "href": "slides/nn_extra_slides/index.html#hierarchy-on-the-intercepts-mean",
    "title": "Extra stuff",
    "section": "Hierarchy on the intercept’s mean",
    "text": "Hierarchy on the intercept’s mean\n\nThe structure of matrix \\(\\mathbf{D}_f\\) can be considered in two different ways in\n\\[\\boldsymbol{\\beta}_{f} \\sim \\mathcal{MVN}(\\boldsymbol{\\mu}_{f}, \\mathbf{D}_f)\\]\nWritten in the general form as we did in the equation above, we assume that all variance on the diagonal are potentially different. Or in other words, the variance in each group is assumed to be different\n\n\n\\[\\mathbf{D}_f = \\begin{bmatrix}\n                \\sigma^2_{f[1]} & 0 & \\dots & 0 & \\dots & 0\\\\\n                0 & \\sigma^2_{f[2]} & \\dots & 0 & \\dots & 0\\\\\n                \\vdots & \\vdots & \\ddots & \\vdots & & \\vdots\\\\\n              0 & 0 & \\dots & \\sigma^2_{f[l]} & \\dots & 0\\\\\n            \\vdots & \\vdots & & \\vdots & \\ddots & \\vdots\\\\\n            0 & 0 & \\dots & 0 & \\dots & \\sigma^2_{f[k]}\\\\\n        \\end{bmatrix}\\]"
  },
  {
    "objectID": "slides/nn_extra_slides/index.html#hierarchy-on-the-intercepts-mean-1",
    "href": "slides/nn_extra_slides/index.html#hierarchy-on-the-intercepts-mean-1",
    "title": "Extra stuff",
    "section": "Hierarchy on the intercept’s mean",
    "text": "Hierarchy on the intercept’s mean\n\nHowever, it can be assumed to be all the same variance regardless of the group considered\n\n\\[\\mathbf{D}_f = \\begin{bmatrix}\n                \\sigma^2_{f} & 0 & \\dots & 0 & \\dots & 0\\\\\n                0 & \\sigma^2_{f} & \\dots & 0 & \\dots & 0\\\\\n                \\vdots & \\vdots & \\ddots & \\vdots & & \\vdots\\\\\n              0 & 0 & \\dots & \\sigma^2_{f} & \\dots & 0\\\\\n            \\vdots & \\vdots & & \\vdots & \\ddots & \\vdots\\\\\n            0 & 0 & \\dots & 0 & \\dots & \\sigma^2_{f}\\\\\n        \\end{bmatrix}\\]\n\nIn this case, \\(\\boldsymbol{\\beta}_{f} \\sim \\mathcal{MVN}(\\boldsymbol{\\mu}_{f}, \\mathbf{D}_f)\\) can be rewritten as \\[\\boldsymbol{\\beta}_{f} \\sim \\mathcal{MVN}(\\boldsymbol{\\mu}_{f}, \\sigma^2_{f}\\mathbf{I})\\] Note: This is essentially the same thing as a one-way analysis of variance."
  }
]