{
  "hash": "8cc30fa654331099a60fab61440b80e1",
  "result": {
    "markdown": "---\ntitle: \"Gaussian process\"\ntitle-slide-attributes: \n  data-background-image: ../img/bg.jpg\n  data-background-size: full\nauthor: \"Guillaume Blanchet -- Andrew MacDonald -- Vincent Tolon\"\ndate: \"2023-05-11\"\nexecute:\n  echo: true\nformat: \n  revealjs:\n    theme: [default]\n    logo: ../img/UdeS_logo_h_rgbHR.png\n    transition: slide\n    background-transition: fade\n---\n\n\n## Hierarchical models so far {style=\"font-size: 0.9em;\"}\n\n. . .\n\n### An already (very !) general formulation\n\n::: {style=\"font-size: 0.75em\"}\nSo far, we have built hierarchical models that can be integrated into the following framework.\n:::\n\n. . .\n\n::: {style=\"font-size: 0.8em\"}\n$$(\\mathbf{y}|\\mathbf{X},\\mathbf{Z}, \\boldsymbol{\\beta}, \\mathbf{b}, \\sigma_\\mathbf{y}^2)\\sim \\mathcal{MVN}(\\mathbf{X} \\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{b}, \\sigma_\\mathbf{y}^2\\mathbf{I})$$\n:::\n\n. . .\n\n::: {style=\"font-size: 0.68em\"}\n\nwhere\n\n$$\\mathbf{b}\\sim \\mathcal{MVN}(\\mu, \\mathbf{\\Sigma})$$\n:::\n\n. . .\n\n::: {style=\"font-size: 0.65em\"}\n\n- $\\mathbf{y}$ is a vector quantifying a response variable of length $n$\n- $\\mathbf{X}$ is a matrix of explanatory variables with $n$ rows (samples) and $p$ columns (explanatory variables) \n- $\\boldsymbol{\\beta}$ is a vector $p$ pararameters weighting the importance of each explanatory variables in $\\mathbf{X}$\n- $\\sigma_\\mathbf{y}^2$ is a measure of variance of the error in the regression model\n- $\\mathbf{I}$ is an $n \\times n$ identity matrix \n\n:::: {style=\"color: blue\"}\n- $\\mathbf{Z}$ is designed matrix of \"explanatory\" variables with $n$ rows (samples) and $q$ columns \n- $\\mu$ is a vector defining the average importance of hierarchical parameters\n- $\\mathbf{\\Sigma}$ is a matrix defining the covariance structure of hierarchical parameters\n::::\n:::\n\n## Hierarchical models so far {style=\"font-size: 0.9em;\"}\n\n### An already (very !) general formulation\n\nAnother way to write this generalized formulation is\n\n$$\\mathbf{y}_i = \\mathbf{X}_{ij} \\boldsymbol{\\beta}_j + \\mathbf{Z}_{ik}\\mathbf{b}_{k} + \\boldsymbol{\\varepsilon}_{ij}$$\nwhere\n\n$$\\mathbf{b}\\sim \\mathcal{MVN}(\\mu, \\mathbf{\\Sigma})$$\nand \n\n$$\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$$\n\n## Even more complex hierarchical models!? {style=\"font-size: 0.9em;\"}\n\nSo far we have seen many (!) versions of hierarchical models, which got increasingly more complex in their structure.\n\n. . .\n\nLet's continue on that slippery slope... \n\n. . . \n\nWould you know how to constraint (spatially, temporally, phylogenetically, etc.) such a model ?\n\n![](https://www.i2symbol.com/pictures/emojis/f/c/3/2/fc326fef420c2381348864310ea8efa1_384.png){fig-align=\"center\" width=30%}\n\n## Even more complex hierarchical models! {style=\"font-size: 0.8em;\"}\n\nIf we get back to a model that has a single hierarchy on the intercept such that\n\n$$\\mathbf{y} \\sim \\mathcal{N}(\\mathbf{b},\\sigma^2)$$\n\n. . .\n\nwhere\n\n$$\\mathbf{b} \\sim \\mathcal{N}(\\mu, \\sigma^2)$$\n\n. . . \n\nIf we want to account for a constraint on the previously presented model we can rewrite the equation fo $\\mathbf{b}$ as \n\n$$\\mathbf{b} \\sim \\mathcal{N}\\left(\\mu, f(d)\\right)$$\n\n. . .\n\nwhere\n\n- $f(d)$ is a function of a distance matrix\n\n## Even more complex hierarchical models! {style=\"font-size: 0.9em;\"}\n\n$$\\mathbf{b} \\sim \\mathcal{N}\\left(\\mu, f(d)\\right)$$\n\n. . .\n\nWhat this equation means conceptually is that the variance associated to $\\mathbf{b}$ is not a constant, it changes based on distance (across space, time, phylogeny, etc.). This is known as a **Gaussian process**.\n\n![](https://t4.ftcdn.net/jpg/05/69/50/21/240_F_569502134_d2TO2BeHCbvOn4imEyFJJ5n6HdiyJg9X.jpg){fig-align=\"center\" width=30%}\n\n## A bit of history\n\n. . .\n\nIn statistics, Gaussian processes have a unique history. The development of this type of model is closely linked to the estimation of mineral deposits. \n\n. . .\n\nSpatial Gaussian processes are also called **geostatistical** models, where the prefix *geo* refers to geology, not geography, as one may be led to believe.\n\n. . .\n\nAs mining engineers are at the root of the development of Gaussian processes, the language associated with this type of model is influenced by this field. \n\n## A bit of history\n\nGaussian processes have been developed in the 1950s by \n\n::::{.columns}\n::: {.column width=\"50%\"}\n![](https://www.nae.edu/File.aspx?id=191706){fig-align=\"center\" width=60%}\n\n:::::{style=\"font-size: 0.9em;\"}\nDaniel G. Krige (1919–2013)\n:::::\n:::\n::: {.column width=\"50%\"}\n![](https://upload.wikimedia.org/wikipedia/commons/5/5c/Georges_Matheron.jpg){fig-align=\"center\" width=75%}\n\n:::::{style=\"font-size: 0.9em;\"}\nGeorges Mathéron (1930–2000)\n:::::\n\n:::\n::::\n\n## Assumption with Gaussian processes\n\n. . .\n\nIn general, when defining a Gaussian process, we make the following assumptions:\n\n. . .\n\n- The closer two sites are, the more similar they are.\n\n. . .\n\n- After a certain distance, it is no longer necessary to consider that a site influences another site.\n\n. . .\n\n\n**Note** The distance of influence of a site on another can be different depending on what is being studied, where it is being studied and when it is being studied\n\n## $f(d)$\n\n. . .\n\nSo, what does $f(d)$ looks like exactly ?\n\n. . .\n\nIn theory, $f(d)$ can be anything... \n\n. . .\n\nHowever, in practice, there are particularities of the functions that are defined by the assumptions we impose on our model.\n\n. . . \n\nAs such, here is a classic structure these variance function take\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-1-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## $f(d)$ - A bit of vocabulary\n\n. . .\n\n### Nugget effect\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## $f(d)$ - A bit of vocabulary\n\n. . .\n\n### Range\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-3-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n## $f(d)$ - A bit of vocabulary\n\n. . .\n\n### Sill\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## $f(d)$ - types of functions {style=\"font-size: 0.85em;\"}\n\n. . .\n\nMany types of functions have been proposed that has this general shape\n\n. . . \n\nIn this lecture, we will use the exponential function\n\n$$C_0 + C_1 \\left(1-e^{-d/a}\\right)$$\n\n. . .\n\nwhere\n\n- $C_0$ is the nugget effect\n\n. . .\n\n- $C_1$ is the sill\n\n. . .\n\n- $d$ is the distance\n\n. . .\n\n- $a$ is the range\n\n## Exponential function\n\nNugget : 2 -- Sill : 5 -- Range : 10\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n## An illustrative example {style=\"font-size: 0.9em;\"}\n\n. . . \n\nTo present how Gaussian processes can be used, let's study the distribution of *Sylvilagus oviparus* in Montréal.\n\n. . .\n\n### A few characteristics of *Sylvilagus oviparus* \n\n- They are found mainly in urban parks of Montréal and is very efficient at hiding in hollow trees and burrows.\n\n. . .\n\n- They lay their eggs (often pastel-coloured) on the Sunday following the first full moon after the spring equinox. \n\n. . .\n\n- They move well in an urban  setting and are not affected by the level of urbanisation\n\n. . .\n\n- They disperse at most 15 km per year\n\n## A typical member of the species\n\n![](https://t3.ftcdn.net/jpg/05/78/06/66/240_F_578066681_18vcVGHuSLDc4dQE6HTXG8qsn2tjSHMy.jpg){fig-align=\"center\" width=75%}\n\n## Distribution of *S. oviparus* in Montréal {style=\"font-size: 0.9em;\"}\n\nIn 2015, a survey was carried out to find *Sylvilagus oviparus* in Montréal's park. Here are the results\n\n\n::::{.columns}\n:::{.column width=\"60%\"}\n![](../img/Lapin_paques_Mtl_2015.png){fig-align=\"center\" width=75%}\n:::\n:::{.column width=\"40%\"}\n\n:::::{style=\"font-size: 0.8em;\"}\nWithin the censused park\n\n- <span style=\"color:blue;\">Blue parks</span> : observed\n\n- <span style=\"color:#FF33FF;\">Pink parks</span> : not observed\n:::::\n:::\n::::\n## second\n\n::: r-fit-text\nTest your model\n:::\n\n## \n\nimg:\n\n![](img/bg.jpg)\n\nit is a landscape\n\n##  {auto-animate=\"true\"}\n\n::: {style=\"margin-top: 100px;\"}\ncheck with simulations\n:::\n\n##  {auto-animate=\"true\"}\n\n::: {style=\"margin-top: 200px; font-size: 2.5em; color: red;\"}\ncheck with simulations\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}